<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Iniciar sesión</title>

<!-- Bootstrap-->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

<!-- CSS -->
<link rel="stylesheet" th:href="@{/css/styles.css}" />
</head>
<body class="bg-page">

<!-- HEADER -->
<header class="bg-mep text-white py-2 shadow-sm">
    <div class="container d-flex align-items-center gap-3">
    <img th:src="@{/img/mep-logo.png}" alt="Logo MEP" height="36" class="logo-mep"/>
    <h1 class="h6 m-0 fw-semibold">Logotipo MEP - Matrículas y Educación pública</h1>
    </div>
</header>

<!-- SUBNAV -->
<nav class="bg-mep-700 text-white">
    <div class="container d-flex gap-4 py-2 small">
    <a class="nav-link-lite" th:href="@{/faq}">Preguntas Frecuentes</a>
    <a class="nav-link-lite" th:href="@{/ayuda}">Ayuda</a>
    <a class="nav-link-lite" th:href="@{/contacto}">Contáctanos</a>
    </div>
</nav>

<!-- CONTENIDO -->
<main class="container py-5">
    <div class="row justify-content-center">
    <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5">
        <div class="card login-card shadow-sm rounded-3">
        <div class="card-body p-4 p-lg-5">

            <!-- Mensajes -->
            <div th:if="${registrationSuccess}" class="alert alert-success py-2" role="alert">
            ¡Registro exitoso! Por favor, inicia sesión.
            </div>

            <div th:if="${param.error}" class="alert alert-danger py-2" role="alert">
            Usuario o contraseña incorrectos.
            </div>

            <!-- >>> AÑADIDO: mensaje para ?denied -->
            <div id="id_sesioncerrada" th:if="${param.denied}">
            <!--  <div class="alert alert-danger">  Aplicando bootstrap-->
            <p style="color:red;">Acceso denegado. No tienes permisos para ver esta página.</p>
            
            </div>


            <!-- FORM -->
            <form th:action="@{/login}" method="post" novalidate>
            
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <div class="mb-3">
                <label for="correo" class="form-label text-muted small fw-semibold">Correo electrónico</label>
                <input type="email" id="correo" name="correo" class="form-control input-mep"
                    placeholder="ejemplo@correo.com" required autocomplete="username">
            </div>

            <div class="mb-4">
                <label for="contrasena" class="form-label text-muted small fw-semibold">Contraseña</label>
                <div class="password-wrap">
                <input type="password" id="contrasena" name="contrasena"
                        class="form-control input-mep password-input"
                        placeholder="Ingrese su contraseña" required autocomplete="current-password">
                <button type="button" class="toggle-pass" aria-label="Mostrar u ocultar contraseña">👁</button>
                </div>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-mep">Iniciar Sesión</button>
            </div>
            </form>

            <p class="text-center mt-4 mb-0 small">
            ¿No tienes una cuenta?
            <a th:href="@{/register}" class="link-mep">Regístrate aquí</a>
            </p>
        </div>
        </div>
    </div>
    </div>
</main>

<!-- mostrar/ocultar contraseña -->
<script>
    (function(){
    const btn = document.querySelector('.toggle-pass');
    const input = document.querySelector('#contrasena');
    if(btn && input){
        btn.addEventListener('click', () => {
        const isPwd = input.type === 'password';
        input.type = isPwd ? 'text' : 'password';
        btn.textContent = isPwd ? '🙈' : '👁';
        input.focus();
        });
    }
    })();
</script>
</body>
</html>
